on_war_started = {  #凝辅国
	trigger = {
		scope:war = {
			using_cb = revolt_independence_war
		}
	}
	on_actions = {
		revolt_independence_on_war_started
	}
}

revolt_independence_on_war_started = {
	effect = {
		scope:attacker = {
			every_liege_or_above = {
				save_scope_as = liege_temp
				if = {
					limit = { NOT = { is_at_war_with = scope:attacker } }
					scope:war = { add_defender = scope:liege_temp }
				}
			}
		}
	}
}

on_county_occupied = {
	trigger = {
		scope:war = {
			using_cb = revolt_independence_war
		}
	}
	on_actions = {
		revolt_independence_war_county_occupied_on_action
	}
}
revolt_independence_war_county_occupied_on_action = {
	effect = {
		if = {
			limit = {
				OR = {
					root = scope:war.primary_attacker
					root = { is_liege_or_above_of = scope:war.primary_attacker }
				}
			}
			create_title_and_vassal_change = {
				type = conquest
				save_scope_as = change
				add_claim_on_loss = no
			}
			scope:county = {
				change_title_holder = {
					holder = root
					change = scope:change
				}
			}
			resolve_title_and_vassal_change = scope:change
		}
	}
}

five_year_playable_pulse = {
	effect = {
			if = {
				limit = { 
					top_liege = { has_primary_title = title:e_celestia }
					has_culture = culture:han
					current_date >= 793.1.1
					current_date <= 887.1.1	
				}
	random_events = { #唐末农民战争
		100 = chinese_revolt.1
		100 = chinese_revolt.4
		100 = chinese_revolt.5
		100 = chinese_revolt.6
		100 = chinese_revolt.7
		100 = chinese_revolt.8
		100 = chinese_revolt.9
		100 = chinese_revolt.22
		100 = chinese_revolt.31
		1 = chinese_revolt.11
	}
}
}
}